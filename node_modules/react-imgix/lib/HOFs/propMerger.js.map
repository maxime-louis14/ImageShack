{"version":3,"file":"propMerger.js","names":["mergeProps","src","destination","newProps","newPropKeys","Object","keys","k","v","indexOf","mergeComponentPropsHOF","Component","mergeComponentPropsHOFInner","props","contextProps","useImgixContext","childProps"],"sources":["../../src/HOFs/propMerger.js"],"sourcesContent":["import React from \"react\";\nimport { useImgixContext } from \"../HOCs\";\n\n/**\n * Merges the `src` object into the `destination` object. Destination values are\n * not overwritten by source values. Destination properties that resolve to\n * `undefined` or `null` are not overwritten if a destination value exists\n * unless destination key does not exist . It recursively merges the\n * `imgixParams` and `htmlAttributes` values.\n *\n * @param {Object} src - The Provider component's props object\n * @param {Object} destination - The child component's props object\n * @returns Object with the combined values from `src` & `destination` Objects\n *\n * @example\n *  const src = {\n *    width: 100,\n *    height: 200,\n *    imgixParams: { ar: \"1:2\", dpr: 2},\n *    htmlAttributes: { styles: \"width: 50\" }\n *  }\n *  const destination = {\n *    width: 101,\n *    height: 201,\n *    imgixParams: { dpr: 1 },\n *    htmlAttributes: { styles: \"width: 100\" }\n *  }\n *  const result = mergeProps(src, destination);\n *\n *  {\n *    width: 101,\n *    height: 201,\n *    imgixParams: { ar: \"1:2\", dpr: 1 },\n *    htmlAttributes: { styles: \"width: 100\" }\n *  }\n *\n */\nexport const mergeProps = (src, destination) => {\n  if (src == null && destination !== null) {\n    return destination;\n  }\n  if (src !== null && destination == null) {\n    return src;\n  }\n  if (src == null && destination == null) {\n    return {};\n  }\n\n  const newProps = { ...destination };\n  const newPropKeys = Object.keys(newProps);\n\n  for (const [k, v] of Object.entries(src)) {\n    if (newPropKeys.indexOf(k) == -1 && v !== null) {\n      newProps[k] = v;\n    }\n    // recursively merge imgixParams and htmlAttributes\n    if (k === \"imgixParams\" || k === \"htmlAttributes\") {\n      if (v !== null) {\n        newProps[k] = mergeProps(src[k], newProps[k]);\n      }\n    }\n  }\n  return newProps;\n};\n\n/**\n * `mergeComponentPropsHOF` tries to invoke `React.useContext()`. If context is\n * `undefined`, context is being accessed outside of an `ImgixContext` provider\n * and the Component is returned as is.\n *\n * Otherwise, it merges a Component's props with the `ImgixContext` props and\n * return a Component with the merged `props`.\n * @param {React.Element <typeof Component} Component -  with defined `props`.\n * @returns Component with merged `props`.\n */\nexport const mergeComponentPropsHOF = (Component) =>\n  function mergeComponentPropsHOFInner(props) {\n    const contextProps = useImgixContext();\n    if (contextProps == null) {\n      return <Component {...props} />;\n    }\n\n    const childProps = mergeProps(contextProps, props);\n    return <Component {...childProps} />;\n  };\n"],"mappings":";;;;;;AAAA;AACA;AAA0C;AAAA;EAAA;EAAA;EAAA;EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAE1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,IAAMA,UAAU,GAAG,SAAbA,UAAU,CAAIC,GAAG,EAAEC,WAAW,EAAK;EAC9C,IAAID,GAAG,IAAI,IAAI,IAAIC,WAAW,KAAK,IAAI,EAAE;IACvC,OAAOA,WAAW;EACpB;EACA,IAAID,GAAG,KAAK,IAAI,IAAIC,WAAW,IAAI,IAAI,EAAE;IACvC,OAAOD,GAAG;EACZ;EACA,IAAIA,GAAG,IAAI,IAAI,IAAIC,WAAW,IAAI,IAAI,EAAE;IACtC,OAAO,CAAC,CAAC;EACX;EAEA,IAAMC,QAAQ,qBAAQD,WAAW,CAAE;EACnC,IAAME,WAAW,GAAGC,MAAM,CAACC,IAAI,CAACH,QAAQ,CAAC;EAEzC,mCAAqB,eAAeF,GAAG,CAAC,qCAAE;IAArC;MAAOM,CAAC;MAAEC,CAAC;IACd,IAAIJ,WAAW,CAACK,OAAO,CAACF,CAAC,CAAC,IAAI,CAAC,CAAC,IAAIC,CAAC,KAAK,IAAI,EAAE;MAC9CL,QAAQ,CAACI,CAAC,CAAC,GAAGC,CAAC;IACjB;IACA;IACA,IAAID,CAAC,KAAK,aAAa,IAAIA,CAAC,KAAK,gBAAgB,EAAE;MACjD,IAAIC,CAAC,KAAK,IAAI,EAAE;QACdL,QAAQ,CAACI,CAAC,CAAC,GAAGP,UAAU,CAACC,GAAG,CAACM,CAAC,CAAC,EAAEJ,QAAQ,CAACI,CAAC,CAAC,CAAC;MAC/C;IACF;EACF;EACA,OAAOJ,QAAQ;AACjB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAUO,IAAMO,sBAAsB,GAAG,SAAzBA,sBAAsB,CAAIC,SAAS;EAAA,OAC9C,SAASC,2BAA2B,CAACC,KAAK,EAAE;IAC1C,IAAMC,YAAY,GAAG,IAAAC,qBAAe,GAAE;IACtC,IAAID,YAAY,IAAI,IAAI,EAAE;MACxB,oBAAO,6BAAC,SAAS,EAAKD,KAAK,CAAI;IACjC;IAEA,IAAMG,UAAU,GAAGhB,UAAU,CAACc,YAAY,EAAED,KAAK,CAAC;IAClD,oBAAO,6BAAC,SAAS,EAAKG,UAAU,CAAI;EACtC,CAAC;AAAA;AAAC"}